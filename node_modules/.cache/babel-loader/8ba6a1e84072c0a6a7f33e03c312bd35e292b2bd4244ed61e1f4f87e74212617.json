{"ast":null,"code":"import _slicedToArray from \"C:/Users/mgriz/flashfinanceUI/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"C:/Users/mgriz/flashfinanceUI/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.object.from-entries.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.starts-with.js\";\n// Utils\nimport { defineComponent as _defineComponent, effectScope, getCurrentInstance, shallowReactive, shallowRef, toRaw, watch, watchEffect } from 'vue';\nimport { consoleWarn } from \"./console.mjs\";\nimport { mergeDeep, toKebabCase } from \"./helpers.mjs\";\nimport { injectSelf } from \"./injectSelf.mjs\";\nimport { DefaultsSymbol, provideDefaults, useDefaults } from \"../composables/defaults.mjs\"; // Types\nimport { propsFactory } from \"./propsFactory.mjs\";\nfunction propIsDefined(vnode, prop) {\n  var _vnode$props, _vnode$props2;\n  return ((_vnode$props = vnode.props) == null ? void 0 : _vnode$props.hasOwnProperty(prop)) || ((_vnode$props2 = vnode.props) == null ? void 0 : _vnode$props2.hasOwnProperty(toKebabCase(prop)));\n}\nexport var defineComponent = function defineComponent(options) {\n  var _options$_setup;\n  options._setup = (_options$_setup = options._setup) !== null && _options$_setup !== void 0 ? _options$_setup : options.setup;\n  if (!options.name) {\n    consoleWarn('The component is missing an explicit name, unable to generate default prop value');\n    return options;\n  }\n  if (options._setup) {\n    var _options$props;\n    options.props = (_options$props = options.props) !== null && _options$props !== void 0 ? _options$props : {};\n    options.props = propsFactory(options.props, options.name)();\n    options.props._as = String;\n    options.setup = function setup(props, ctx) {\n      var vm = getCurrentInstance();\n      var defaults = useDefaults();\n      var _subcomponentDefaults = shallowRef();\n      var _props = shallowReactive(_objectSpread({}, toRaw(props)));\n      watchEffect(function () {\n        var _props$_as;\n        var globalDefaults = defaults.value.global;\n        var componentDefaults = defaults.value[(_props$_as = props._as) !== null && _props$_as !== void 0 ? _props$_as : options.name];\n        if (componentDefaults) {\n          var subComponents = Object.entries(componentDefaults).filter(function (_ref) {\n            var _ref2 = _slicedToArray(_ref, 1),\n              key = _ref2[0];\n            return key.startsWith('V');\n          });\n          if (subComponents.length) _subcomponentDefaults.value = Object.fromEntries(subComponents);\n        }\n        for (var _i = 0, _Object$keys = Object.keys(props); _i < _Object$keys.length; _i++) {\n          var prop = _Object$keys[_i];\n          var newVal = props[prop];\n          if (!propIsDefined(vm.vnode, prop)) {\n            var _ref3, _ref4;\n            newVal = (_ref3 = (_ref4 = componentDefaults == null ? void 0 : componentDefaults[prop]) !== null && _ref4 !== void 0 ? _ref4 : globalDefaults == null ? void 0 : globalDefaults[prop]) !== null && _ref3 !== void 0 ? _ref3 : props[prop];\n          }\n          if (_props[prop] !== newVal) {\n            _props[prop] = newVal;\n          }\n        }\n      });\n      var setupBindings = options._setup(_props, ctx);\n      var scope;\n      watch(_subcomponentDefaults, function (val, oldVal) {\n        if (!val && scope) scope.stop();else if (val && !oldVal) {\n          scope = effectScope();\n          scope.run(function () {\n            var _ref5;\n            var _injectSelf;\n            provideDefaults(mergeDeep((_ref5 = (_injectSelf = injectSelf(DefaultsSymbol)) == null ? void 0 : _injectSelf.value) !== null && _ref5 !== void 0 ? _ref5 : {}, val));\n          });\n        }\n      }, {\n        immediate: true\n      });\n      return setupBindings;\n    };\n  }\n  return options;\n};\nexport function genericComponent() {\n  var exposeDefaults = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n  return function (options) {\n    return (exposeDefaults ? defineComponent : _defineComponent)(options);\n  };\n}","map":{"version":3,"names":["defineComponent","_defineComponent","effectScope","getCurrentInstance","shallowReactive","shallowRef","toRaw","watch","watchEffect","consoleWarn","mergeDeep","toKebabCase","injectSelf","DefaultsSymbol","provideDefaults","useDefaults","propsFactory","propIsDefined","vnode","prop","_vnode$props","_vnode$props2","props","hasOwnProperty","options","_options$_setup","_setup","setup","name","_options$props","_as","String","ctx","vm","defaults","_subcomponentDefaults","_props","_objectSpread","_props$_as","globalDefaults","value","global","componentDefaults","subComponents","Object","entries","filter","_ref","_ref2","_slicedToArray","key","startsWith","length","fromEntries","_i","_Object$keys","keys","newVal","_ref3","_ref4","setupBindings","scope","val","oldVal","stop","run","_ref5","_injectSelf","immediate","genericComponent","exposeDefaults","arguments","undefined"],"sources":["../../src/util/defineComponent.tsx"],"sourcesContent":["// Utils\nimport {\n  defineComponent as _defineComponent,\n  effectScope,\n  getCurrentInstance,\n  shallowReactive,\n  shallowRef,\n  toRaw,\n  watch,\n  watchEffect,\n} from 'vue'\nimport { consoleWarn } from '@/util/console'\nimport { mergeDeep, toKebabCase } from '@/util/helpers'\nimport { injectSelf } from '@/util/injectSelf'\nimport { DefaultsSymbol, provideDefaults, useDefaults } from '@/composables/defaults'\n\n// Types\nimport type {\n  ComponentOptions,\n  ComponentOptionsMixin,\n  ComponentOptionsWithObjectProps,\n  ComponentPropsOptions,\n  ComputedOptions,\n  DefineComponent,\n  EffectScope,\n  EmitsOptions,\n  MethodOptions,\n  VNode,\n  VNodeChild,\n} from 'vue'\nimport { propsFactory } from '@/util/propsFactory'\n\nfunction propIsDefined (vnode: VNode, prop: string) {\n  return vnode.props?.hasOwnProperty(prop) ||\n  vnode.props?.hasOwnProperty(toKebabCase(prop))\n}\n\nexport const defineComponent = (function defineComponent (options: ComponentOptions) {\n  options._setup = options._setup ?? options.setup\n\n  if (!options.name) {\n    consoleWarn('The component is missing an explicit name, unable to generate default prop value')\n\n    return options\n  }\n\n  if (options._setup) {\n    options.props = options.props ?? {}\n\n    options.props = propsFactory(options.props, options.name)()\n\n    options.props._as = String\n    options.setup = function setup (props: Record<string, any>, ctx) {\n      const vm = getCurrentInstance()!\n      const defaults = useDefaults()\n\n      const _subcomponentDefaults = shallowRef()\n      const _props = shallowReactive({ ...toRaw(props) })\n      watchEffect(() => {\n        const globalDefaults = defaults.value.global\n        const componentDefaults = defaults.value[props._as ?? options.name!]\n\n        if (componentDefaults) {\n          const subComponents = Object.entries(componentDefaults).filter(([key]) => key.startsWith('V'))\n          if (subComponents.length) _subcomponentDefaults.value = Object.fromEntries(subComponents)\n        }\n\n        for (const prop of Object.keys(props)) {\n          let newVal = props[prop]\n          if (!propIsDefined(vm.vnode, prop)) {\n            newVal = componentDefaults?.[prop] ?? globalDefaults?.[prop] ?? props[prop]\n          }\n          if (_props[prop] !== newVal) {\n            _props[prop] = newVal\n          }\n        }\n      })\n\n      const setupBindings = options._setup(_props, ctx)\n\n      let scope: EffectScope\n      watch(_subcomponentDefaults, (val, oldVal) => {\n        if (!val && scope) scope.stop()\n        else if (val && !oldVal) {\n          scope = effectScope()\n          scope.run(() => {\n            provideDefaults(mergeDeep(injectSelf(DefaultsSymbol)?.value ?? {}, val))\n          })\n        }\n      }, { immediate: true })\n\n      return setupBindings\n    }\n  }\n\n  return options\n}) as unknown as typeof _defineComponent\n\ntype ToListeners<T extends string | number | symbol> = { [K in T]: K extends `on${infer U}` ? Uncapitalize<U> : K }[T]\n\nexport type SlotsToProps<T extends Record<string, any>> = T extends Record<string, Slot> ? ({\n  $children?: (\n    | VNodeChild\n    | (keyof T extends 'default' ? T['default'] : {})\n    | { [K in keyof T]?: T[K] }\n  )\n  'v-slots'?: { [K in keyof T]?: T[K] | false }\n} & {\n  [K in keyof T as `v-slot:${K & string}`]?: T[K] | false\n}) : T extends Record<string, any[]> ? SlotsToProps<MakeSlots<T>> : never\n\ntype Slot<T extends any[] = any[]> = (...args: T) => VNodeChild\nexport type MakeSlots<T extends Record<string, any[]>> = {\n  [K in keyof T]?: Slot<T[K]>\n}\n\nexport function genericComponent<T extends (new () => {\n  $props?: Record<string, any>\n})> (exposeDefaults = true): <\n  PropsOptions extends Readonly<ComponentPropsOptions>,\n  RawBindings,\n  D,\n  C extends ComputedOptions = {},\n  M extends MethodOptions = {},\n  Mixin extends ComponentOptionsMixin = ComponentOptionsMixin,\n  Extends extends ComponentOptionsMixin = ComponentOptionsMixin,\n  E extends EmitsOptions = Record<string, any>,\n  EE extends string = string,\n  I = InstanceType<T>,\n  Base = DefineComponent<\n    I extends Record<'$props', any>\n      ? Omit<PropsOptions, keyof I['$props']>\n      : PropsOptions,\n    RawBindings,\n    D,\n    C,\n    M,\n    Mixin,\n    Extends,\n    E extends any[] ? E : I extends Record<'$props', any> ? Omit<E, ToListeners<keyof I['$props']>> : E,\n    EE\n  >\n>(options: ComponentOptionsWithObjectProps<PropsOptions, RawBindings, D, C, M, Mixin, Extends, E, EE>) => Base & T {\n  return options => (exposeDefaults ? defineComponent : _defineComponent)(options) as any\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}